/api/v1/auth/login:
  post:
    tags: [Auth]
    summary: Login
    description: Authenticate with email and password. Returns user and JWT token.
    security: []
    operationId: login
    x-roles: [PUBLIC]
    requestBody:
      required: true
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/LoginRequest'
          example:
            email: "admin@gmail.com"
            password: "admin123!"
    responses:
      "200":
        description: Login successful
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/LoginResponse'
            example:
              user:
                id: "01933c5e-7f2a-7a00-8000-1a2b3c4d5e6f"
                name: "John Doe"
                email: "admin@gmail.com"
                role: "CLIENT"
              token: "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9..."
      "401":
        description: Invalid credentials
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/ErrorResponse'
            example:
              success: false
              message: "Invalid email or password"
      "400":
        description: Validation error
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/ErrorResponse'

/api/v1/auth/logout:
  post:
    tags: [Auth]
    summary: Logout
    description: Invalidate current session. Requires authentication.
    operationId: logout
    x-roles: [ADMIN, GM, TM, TO, TA, SURVEYOR, CLIENT, FLAG_ADMIN]
    responses:
      "200":
        description: Logged out successfully
        content:
          application/json:
            schema:
              type: object
              properties:
                message:
                  type: string
                  example: "Logged out successfully"
                token:
                  type: "null"
            example:
              message: "Logged out successfully"
              token: null
      "401":
        description: Not authenticated
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/ErrorResponse'

/api/v1/auth/refresh-token:
  post:
    tags: [Auth]
    summary: Refresh token
    description: Get new access token using refresh token.
    security: []
    operationId: refreshToken
    x-roles: [PUBLIC]
    requestBody:
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/RefreshTokenRequest'
    responses:
      "200":
        description: Token refreshed
        content:
          application/json:
            schema:
              type: object
              properties:
                user:
                  $ref: '#/components/schemas/UserSummary'
                token:
                  type: string
      "401":
        description: Invalid refresh token
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/ErrorResponse'

/api/v1/auth/forgot-password:
  post:
    tags: [Auth]
    summary: Forgot password
    description: Request password reset email.
    security: []
    operationId: forgotPassword
    x-roles: [PUBLIC]
    requestBody:
      required: true
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/ForgotPasswordRequest'
          example:
            email: "user@girik.com"
    responses:
      "200":
        description: Password reset email sent
        content:
          application/json:
            schema:
              type: object
              properties:
                message:
                  type: string
                  example: "Password reset email sent"
            example:
              message: "Password reset email sent"
      "400":
        description: Validation error
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/ErrorResponse'

/api/v1/auth/reset-password:
  post:
    tags: [Auth]
    summary: Reset password
    description: Reset password using token from email.
    security: []
    operationId: resetPassword
    x-roles: [PUBLIC]
    requestBody:
      required: true
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/ResetPasswordRequest'
          example:
            token: "reset-token-from-email"
            newPassword: "NewSecurePass123!"
    responses:
      "200":
        description: Password reset successfully
        content:
          application/json:
            schema:
              type: object
              properties:
                message:
                  type: string
                  example: "Password reset successfully"
      "400":
        description: Invalid or expired token
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/ErrorResponse'
