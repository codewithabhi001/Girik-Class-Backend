/api/v1/surveys/start:
  post:
    tags: [Surveys]
    summary: Start survey
    operationId: startSurvey
    x-roles: [SURVEYOR]
    requestBody:
      required: true
      content:
        application/json:
          schema:
            type: object
            required: [job_id, latitude, longitude]
            properties:
              job_id: { type: string, format: uuid }
              latitude: { type: number }
              longitude: { type: number }
          example:
            job_id: "01933c5e-7f2a-7a00-8000-1a2b3c4d5e6f"
            latitude: 1.3521
            longitude: 103.8198
    responses:
      "201": { description: Survey started }
      "403": { description: Forbidden }

/api/v1/surveys:
  post:
    tags: [Surveys]
    summary: Submit survey report
    operationId: submitSurveyReport
    x-roles: [SURVEYOR]
    requestBody:
      content:
        multipart/form-data:
          schema:
            type: object
            required: [job_id, gps_latitude, gps_longitude, survey_statement]
            properties:
              job_id: { type: string }
              gps_latitude: { type: number }
              gps_longitude: { type: number }
              survey_statement: { type: string }
              reason_if_outside: { type: string }
              photo: { type: string, format: binary }
          example:
            job_id: "01933c5e-7f2a-7a00-8000-1a2b3c4d5e6f"
            gps_latitude: 1.3521
            gps_longitude: 103.8198
            survey_statement: "Survey completed. All items checked. Vessel in good condition."
            reason_if_outside: ""
    responses:
      "201": { description: Survey submitted }
      "403": { description: Forbidden }

  get:
    tags: [Surveys]
    summary: Get survey reports
    operationId: getSurveyReports
    x-roles: [ADMIN, GM, TM, TO]
    responses:
      "200": { description: List of survey reports }
      "403": { description: Forbidden }

/api/v1/surveys/{id}/finalize:
  put:
    tags: [Surveys]
    summary: Finalize survey
    operationId: finalizeSurvey
    x-roles: [SURVEYOR]
    parameters:
      - name: id
        in: path
        required: true
        schema: { type: string, format: uuid }
    responses:
      "200": { description: Survey finalized }
      "403": { description: Forbidden }

/api/v1/surveys/{id}/location:
  post:
    tags: [Surveys]
    summary: Stream location (GPS update)
    operationId: streamLocation
    x-roles: [SURVEYOR]
    parameters:
      - name: id
        in: path
        required: true
        schema: { type: string, format: uuid }
    requestBody:
      content:
        application/json:
          schema:
            type: object
            required: [vessel_id, latitude, longitude]
            properties:
              vessel_id: { type: string, format: uuid }
              latitude: { type: number }
              longitude: { type: number }
          example:
            vessel_id: "01933c5e-7f2a-7a00-8000-1a2b3c4d5e6f"
            latitude: 1.3521
            longitude: 103.8198
    responses:
      "200": { description: Location updated }
      "403": { description: Forbidden }

/api/v1/surveys/{id}/proof:
  post:
    tags: [Surveys]
    summary: Upload proof
    operationId: uploadProof
    x-roles: [SURVEYOR]
    parameters:
      - name: id
        in: path
        required: true
        schema: { type: string, format: uuid }
    requestBody:
      content:
        multipart/form-data:
          schema:
            type: object
            properties:
              proof: { type: string, format: binary }
    responses:
      "201": { description: Proof uploaded }
      "403": { description: Forbidden }

/api/v1/surveys/{id}/timeline:
  get:
    tags: [Surveys]
    summary: Get survey timeline
    operationId: getSurveyTimeline
    x-roles: [ADMIN, GM, TM]
    parameters:
      - name: id
        in: path
        required: true
        schema: { type: string, format: uuid }
    responses:
      "200": { description: Survey timeline }
      "403": { description: Forbidden }

/api/v1/surveys/{id}/violation:
  post:
    tags: [Surveys]
    summary: Flag violation
    operationId: flagViolation
    x-roles: [ADMIN, TM]
    parameters:
      - name: id
        in: path
        required: true
        schema: { type: string, format: uuid }
    requestBody:
      content:
        application/json:
          schema:
            type: object
            properties:
              reason: { type: string }
          example:
            reason: "Surveyor found non-compliance at location"
    responses:
      "200": { description: Violation flagged }
      "403": { description: Forbidden }
