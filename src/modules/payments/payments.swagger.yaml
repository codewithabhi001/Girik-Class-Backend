paths:
  /payments:
    get:
      summary: List Payments
      description: Retrieve a list of invoices and payment records.
      tags: [Payments]
      security:
        - bearerAuth: []
      x-roles: [CLIENT, ADMIN, GM, TM]
      responses:
        '200':
          description: List of payments
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/SuccessResponse'

  /payments/invoice:
    post:
      summary: Create Invoice
      description: Generate a new invoice for a job or service.
      tags: [Payments]
      security:
        - bearerAuth: []
      x-roles: [ADMIN, GM, TM]
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required: [job_id, amount, currency]
              properties:
                job_id: [type: string, format: uuid]
                amount: [type: number]
                currency: [type: string, default: USD]
                due_date: [type: string, format: date]
      responses:
        '201':
          description: Invoice created
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/SuccessResponse'

  /payments/summary:
    get:
      summary: Financial Summary
      description: Retrieve aggregated financial data (outstanding balance, total paid).
      tags: [Payments]
      security:
        - bearerAuth: []
      x-roles: [CLIENT, ADMIN, GM]
      responses:
        '200':
          description: Summary data
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/SuccessResponse'

  /payments/{id}:
    get:
      summary: Get Payment Details
      description: Retrieve details of a specific payment or invoice.
      tags: [Payments]
      security:
        - bearerAuth: []
      x-roles: [CLIENT, ADMIN, GM, TM]
      parameters:
        - in: path
          name: id
          required: true
          schema: [type: string, format: uuid]
      responses:
        '200':
          description: Payment details
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/SuccessResponse'

  /payments/{id}/pay:
    put:
      summary: Mark as Paid
      description: Update invoice status to PAID.
      tags: [Payments]
      security:
        - bearerAuth: []
      x-roles: [ADMIN, GM, TM]
      parameters:
        - in: path
          name: id
          required: true
          schema: [type: string, format: uuid]
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required: [payment_method, transaction_id]
              properties:
                payment_method: [type: string]
                transaction_id: [type: string]
      responses:
        '200':
          description: Payment recorded
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/SuccessResponse'
