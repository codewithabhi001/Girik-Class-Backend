LoginRequest:
  type: object
  required:
    - email
    - password
  properties:
    email:
      type: string
      format: email
      example: "admin@girik.com"
    password:
      type: string
      format: password
      example: "SecurePass123!"
  example:
    email: "admin@girik.com"
    password: "SecurePass123!"

LoginResponse:
  type: object
  description: "Returns user and both tokens. Use accessToken for API calls (Bearer header); use refreshToken only at POST /auth/refresh-token. Store tokens securely."
  properties:
    user:
      $ref: '#/components/schemas/UserSummary'
    accessToken:
      type: string
      description: "Short-lived JWT for API auth. Send in header: Authorization Bearer &lt;accessToken&gt;"
      example: "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9..."
    refreshToken:
      type: string
      description: "Long-lived JWT; use only to get new access token via POST /auth/refresh-token"
      example: "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9..."
  example:
    user:
      id: "01933c5e-7f2a-7a00-8000-1a2b3c4d5e6f"
      name: "John Doe"
      email: "admin@girik.com"
      role: "CLIENT"
    accessToken: "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9..."
    refreshToken: "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9..."

LogoutResponse:
  type: object
  properties:
    message:
      type: string
      example: "Logged out successfully"
    accessToken:
      type: string
      nullable: true
      description: "Always null after logout"
    refreshToken:
      type: string
      nullable: true
      description: "Always null after logout"

UserSummary:
  type: object
  properties:
    id:
      $ref: '#/components/schemas/UUID'
    name:
      type: string
      example: "John Doe"
    email:
      type: string
      format: email
      example: "admin@girik.com"
    role:
      type: string
      enum: [ADMIN, GM, TM, TO, TA, SURVEYOR, CLIENT, FLAG_ADMIN]
      example: "CLIENT"
    client_id:
      $ref: '#/components/schemas/UUID'
      nullable: true

ForgotPasswordRequest:
  type: object
  required:
    - email
  properties:
    email:
      type: string
      format: email
      example: "user@girik.com"

ResetPasswordRequest:
  type: object
  required:
    - token
    - newPassword
  properties:
    token:
      type: string
      description: "Reset token from email"
    newPassword:
      type: string
      format: password
      minLength: 8
      pattern: '^(?=.*[a-z])(?=.*[A-Z])(?=.*\d)'
      example: 'SecurePass123'

RefreshTokenRequest:
  type: object
  description: "Send refresh token in body (refreshToken or token). Cookie refreshToken is also accepted."
  properties:
    refreshToken:
      type: string
      description: "Refresh token from login/register or previous refresh"
    token:
      type: string
      description: "Alias for refreshToken (legacy)"

RefreshTokenResponse:
  type: object
  properties:
    user:
      $ref: '#/components/schemas/UserSummary'
    accessToken:
      type: string
      description: "New short-lived access token for API calls"
    refreshToken:
      type: string
      description: "New long-lived refresh token; store and use for next refresh"
