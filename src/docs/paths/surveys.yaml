/surveys/start:
  post:
    tags: [Surveys]
    summary: Start Survey
    x-roles: [SURVEYOR]
    requestBody:
      required: true
      content:
        application/json:
          schema:
            type: object
            required: [job_id, latitude, longitude]
            properties:
              job_id:
                $ref: '#/components/schemas/UUID'
              latitude:
                type: number
                example: 1.3521
              longitude:
                type: number
                example: 103.8198
          example:
            job_id: "550e8400-e29b-41d4-a716-446655440000"
            latitude: 1.3521
            longitude: 103.8198
    responses:
      '201':
        description: Survey started
      '400':
        $ref: '#/components/responses/BadRequest'

/surveys:
  post:
    tags: [Surveys]
    summary: Submit Survey Report
    x-roles: [SURVEYOR]
    requestBody:
      content:
        multipart/form-data:
          schema:
            type: object
            properties:
              job_id:
                type: string
                format: uuid
              gps_latitude:
                type: number
              gps_longitude:
                type: number
              survey_statement:
                type: string
              reason_if_outside:
                type: string
              photo:
                type: string
                format: binary
    responses:
      '201':
        description: Report submitted
  get:
    tags: [Surveys]
    summary: List Survey Reports
    x-roles: [ADMIN, GM, TM, TO]
    responses:
      '200':
        description: List of survey reports

/surveys/{id}/finalize:
  put:
    tags: [Surveys]
    summary: Finalize Survey
    x-roles: [SURVEYOR]
    parameters:
      - name: id
        in: path
        required: true
        schema:
          type: string
          format: uuid
    responses:
      '200':
        description: Survey finalized

/surveys/{id}/location:
  post:
    tags: [Surveys]
    summary: Stream Location
    x-roles: [SURVEYOR]
    parameters:
      - name: id
        in: path
        required: true
        schema:
          type: string
          format: uuid
    requestBody:
      content:
        application/json:
          schema:
            type: object
            required: [latitude, longitude]
            properties:
              latitude:
                type: number
              longitude:
                type: number
    responses:
      '200':
        description: Location updated

/surveys/{id}/proof:
  post:
    tags: [Surveys]
    summary: Upload Proof
    x-roles: [SURVEYOR]
    parameters:
      - name: id
        in: path
        required: true
        schema:
          type: string
          format: uuid
    requestBody:
      content:
        multipart/form-data:
          schema:
            type: object
            properties:
              proof:
                type: string
                format: binary
    responses:
      '201':
        description: Proof uploaded

/surveys/{id}/timeline:
  get:
    tags: [Surveys]
    summary: Survey Timeline
    x-roles: [ADMIN, GM, TM]
    parameters:
      - name: id
        in: path
        required: true
        schema:
          type: string
          format: uuid
    responses:
      '200':
        description: Timeline data

/surveys/{id}/violation:
  post:
    tags: [Surveys]
    summary: Flag Violation
    x-roles: [ADMIN, TM]
    parameters:
      - name: id
        in: path
        required: true
        schema:
          type: string
          format: uuid
    requestBody:
      content:
        application/json:
          schema:
            type: object
            properties:
              description:
                type: string
    responses:
      '201':
        description: Violation flagged
