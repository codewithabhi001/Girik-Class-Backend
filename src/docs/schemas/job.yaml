JobCreateRequest:
  type: object
  required:
    - vessel_id
    - certificate_type_id
    - reason
    - target_port
    - target_date
  properties:
    vessel_id:
      $ref: '#/components/schemas/UUID'
    certificate_type_id:
      $ref: '#/components/schemas/UUID'
    reason:
      type: string
      example: "Annual survey due"
    target_port:
      type: string
      example: "Singapore"
    target_date:
      type: string
      format: date
      example: "2026-03-15"
    remarks:
      type: string

JobResponse:
  type: object
  properties:
    id:
      $ref: '#/components/schemas/UUID'
    vessel_id:
      $ref: '#/components/schemas/UUID'
    certificate_type_id:
      $ref: '#/components/schemas/UUID'
    reason:
      type: string
    target_port:
      type: string
    target_date:
      type: string
      format: date
    assigned_surveyor_id:
      $ref: '#/components/schemas/UUID'
      nullable: true
    assigned_by_user_id:
      $ref: '#/components/schemas/UUID'
      nullable: true
    approved_by_user_id:
      $ref: '#/components/schemas/UUID'
      nullable: true
    generated_certificate_id:
      $ref: '#/components/schemas/UUID'
      nullable: true
    remarks:
      type: string
    job_status:
      type: string
      enum: [CREATED, DOCUMENT_VERIFIED, APPROVED, ASSIGNED, SURVEY_AUTHORIZED, IN_PROGRESS, SURVEY_DONE, REVIEWED, FINALIZED, REWORK_REQUESTED, PAYMENT_DONE, CERTIFIED, REJECTED]
      example: "CREATED"
    priority:
      type: string
      enum: [LOW, NORMAL, HIGH, URGENT]
      default: NORMAL
      description: "Management priority flag. Set/changed via PUT /jobs/:id/priority â€” not accepted at creation time."
    vessel:
      $ref: '#/components/schemas/VesselSummary'
    certificate_type:
      type: object
      properties:
        id:
          $ref: '#/components/schemas/UUID'
        name:
          type: string
    created_at:
      type: string
      format: date-time
    updated_at:
      type: string
      format: date-time
  example:
    id: "01933c5e-7f2a-7a00-8000-1a2b3c4d5e6f"
    vessel_id: "01933c5e-7f2a-7a00-8000-1a2b3c4d5e6f"
    job_status: "CREATED"
    reason: "Annual survey due"
    target_port: "Singapore"
    target_date: "2026-03-15"

JobStatusUpdateRequest:
  type: object
  required: [status]
  properties:
    status:
      type: string
      enum: [CREATED, APPROVED, ASSIGNED, SURVEY_AUTHORIZED, IN_PROGRESS, SURVEY_DONE, REVIEWED, FINALIZED, REWORK_REQUESTED, PAYMENT_DONE, CERTIFIED, REJECTED]
    remarks:
      type: string

AssignSurveyorRequest:
  type: object
  required:
    - surveyorId
  properties:
    surveyorId:
      $ref: '#/components/schemas/UUID'

ReassignJobRequest:
  type: object
  required:
    - surveyorId
    - reason
  properties:
    surveyorId:
      $ref: '#/components/schemas/UUID'
    reason:
      type: string

RescheduleJobRequest:
  type: object
  required:
    - reason
  properties:
    new_target_date:
      type: string
      format: date
    new_target_port:
      type: string
    reason:
      type: string

EscalateJobRequest:
  type: object
  required:
    - reason
    - target_role
  properties:
    reason:
      type: string
    target_role:
      type: string
      enum: [GM, ADMIN]

JobCancelRequest:
  type: object
  required: [reason]
  properties:
    reason:
      type: string

AddNoteRequest:
  type: object
  required:
    - note_text
  properties:
    note_text:
      type: string
    is_internal:
      type: boolean
      default: true

MessageCreateRequest:
  type: object
  required:
    - content
  properties:
    content:
      type: string

JobHistoryItem:
  type: object
  properties:
    id:
      $ref: '#/components/schemas/UUID'
    job_id:
      $ref: '#/components/schemas/UUID'
    old_status:
      type: string
      nullable: true
    new_status:
      type: string
    changed_by:
      $ref: '#/components/schemas/UUID'
    change_reason:
      type: string
    created_at:
      type: string
      format: date-time
    User:
      type: object
      properties:
        name:
          type: string
        email:
          type: string
        role:
          type: string

JobNoteResponse:
  type: object
  properties:
    id:
      $ref: '#/components/schemas/UUID'
    job_id:
      $ref: '#/components/schemas/UUID'
    user_id:
      $ref: '#/components/schemas/UUID'
    note_text:
      type: string
    is_internal:
      type: boolean
    created_at:
      type: string
      format: date-time

JobMessageResponse:
  type: object
  properties:
    id:
      $ref: '#/components/schemas/UUID'
    job_id:
      $ref: '#/components/schemas/UUID'
    sender_id:
      $ref: '#/components/schemas/UUID'
    message_text:
      type: string
    is_internal:
      type: boolean
    attachment_url:
      type: string
      format: uri
      nullable: true
    created_at:
      type: string
      format: date-time
    Sender:
      type: object
      properties:
        name:
          type: string
        role:
          type: string
