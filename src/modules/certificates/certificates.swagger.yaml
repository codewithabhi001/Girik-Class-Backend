paths:
  /certificates:
    get:
      summary: List Certificates
      description: Retrieve a paginated list of certificates.
      tags: [Certificates]
      security:
        - bearerAuth: []
      x-roles: [CLIENT, ADMIN, GM, TM, TO, SURVEYOR]
      parameters:
        - in: query
          name: page
          schema:
            type: integer
            default: 1
        - in: query
          name: limit
          schema:
            type: integer
            default: 10
        - in: query
          name: search
          schema:
            type: string
            description: Search by certificate number or vessel
      responses:
        '200':
          description: List of certificates
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PaginationResponse'

    post:
      summary: Generate Certificate
      description: Issue a new certificate for a completed job.
      tags: [Certificates]
      security:
        - bearerAuth: []
      x-roles: [ADMIN, GM, TM]
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required: [jobId, type, issueDate, expiryDate]
              properties:
                jobId:
                  type: string
                  format: uuid
                type:
                  type: string
                  enum: [SAFETY, POLLUTION, SECURITY, CREW]
                issueDate:
                  type: string
                  format: date
                expiryDate:
                  type: string
                  format: date
      responses:
        '201':
          description: Certificate generated
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/SuccessResponse'

  /certificates/verify/{number}:
    get:
      summary: Public Verification
      description: Verify the validity of a certificate by its number. Public access.
      tags: [Certificates]
      parameters:
        - in: path
          name: number
          required: true
          schema:
            type: string
            description: Certificate Number
      responses:
        '200':
          description: Certificate valid
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/SuccessResponse'
        '404':
          description: Certificate not found or invalid
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  /certificates/types:
    get:
      summary: Certificate Types
      description: Get a list of available certificate types.
      tags: [Certificates]
      security:
        - bearerAuth: []
      x-roles: [CLIENT, ADMIN, GM, TM, TO, SURVEYOR]
      responses:
        '200':
          description: List of types
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/SuccessResponse'

  /certificates/expiring:
    get:
      summary: Expiring Certificates
      description: Get a list of certificates expiring soon (e.g., within 30 days).
      tags: [Certificates]
      security:
        - bearerAuth: []
      x-roles: [CLIENT, ADMIN, GM, TM, TO]
      responses:
        '200':
          description: List of expiring certificates
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/SuccessResponse'

  /certificates/{id}:
    get:
      summary: Get Certificate
      description: Retrieve details of a specific certificate.
      tags: [Certificates]
      security:
        - bearerAuth: []
      x-roles: [CLIENT, ADMIN, GM, TM, TO, SURVEYOR]
      parameters:
        - in: path
          name: id
          required: true
          schema:
            type: string
            format: uuid
      responses:
        '200':
          description: Certificate details
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/SuccessResponse'

  /certificates/{id}/revoke:
    put:
      summary: Revoke Certificate
      description: Invalidate a certificate before its expiry.
      tags: [Certificates]
      security:
        - bearerAuth: []
      x-roles: [ADMIN, TM]
      parameters:
        - in: path
          name: id
          required: true
          schema:
            type: string
            format: uuid
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required: [reason]
              properties:
                reason:
                  type: string
      responses:
        '200':
          description: Revoked
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/SuccessResponse'

  /certificates/{id}/suspend:
    put:
      summary: Suspend Certificate
      description: Temporarily suspend a certificate.
      tags: [Certificates]
      security:
        - bearerAuth: []
      x-roles: [ADMIN, TM]
      parameters:
        - in: path
          name: id
          required: true
          schema:
            type: string
            format: uuid
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required: [reason]
              properties:
                reason:
                  type: string
      responses:
        '200':
          description: Suspended
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/SuccessResponse'

  /certificates/{id}/restore:
    put:
      summary: Restore Certificate
      description: Reactivate a suspended certificate.
      tags: [Certificates]
      security:
        - bearerAuth: []
      x-roles: [ADMIN, TM]
      parameters:
        - in: path
          name: id
          required: true
          schema:
            type: string
            format: uuid
      responses:
        '200':
          description: Restored
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/SuccessResponse'

  /certificates/{id}/renew:
    put:
      summary: Renew Certificate
      description: Extend the validity of an existing certificate.
      tags: [Certificates]
      security:
        - bearerAuth: []
      x-roles: [ADMIN, TM]
      parameters:
        - in: path
          name: id
          required: true
          schema:
            type: string
            format: uuid
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required: [newExpiryDate]
              properties:
                newExpiryDate:
                  type: string
                  format: date
      responses:
        '200':
          description: Renewed
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/SuccessResponse'

  /certificates/{id}/preview:
    get:
      summary: Preview Certificate
      description: Generate a PDF preview of the certificate.
      tags: [Certificates]
      security:
        - bearerAuth: []
      x-roles: [CLIENT, ADMIN, GM, TM, TO, SURVEYOR]
      parameters:
        - in: path
          name: id
          required: true
          schema:
            type: string
            format: uuid
      responses:
        '200':
          description: PDF URL
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/SuccessResponse'
