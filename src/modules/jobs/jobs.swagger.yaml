paths:
  /jobs:
    get:
      summary: List all jobs
      description: Retrieve a list of jobs with pagination and filtering. Clients see only their jobs.
      tags: [Jobs]
      security:
        - bearerAuth: []
      x-roles: [CLIENT, ADMIN, GM, TM, TO, SURVEYOR]
      parameters:
        - in: query
          name: page
          schema:
            type: integer
            default: 1
        - in: query
          name: limit
          schema:
            type: integer
            default: 10
        - in: query
          name: status
          schema:
            type: string
      responses:
        '200':
          description: List of jobs
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PaginationResponse'
        '401':
          $ref: '#/components/responses/Unauthorized'

    post:
      summary: Create a new job
      description: Create a new survey job request for a vessel.
      tags: [Jobs]
      security:
        - bearerAuth: []
      x-roles: [CLIENT, ADMIN, GM]
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - vesselId
                - type
              properties:
                vesselId:
                  type: string
                  format: uuid
                  description: ID of the vessel for the job
                type:
                  type: string
                  description: Type of job (Survey, Audit, etc.)
                notes:
                  type: string
                  description: Additional notes for the request
      responses:
        '201':
          description: Job created successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/SuccessResponse'
        '400':
          description: Validation Error

  /jobs/{id}:
    get:
      summary: Get job details
      description: Retrieve detailed information about a specific job.
      tags: [Jobs]
      security:
        - bearerAuth: []
      x-roles: [CLIENT, ADMIN, GM, TM, TO, SURVEYOR]
      parameters:
        - in: path
          name: id
          required: true
          schema:
            type: string
            format: uuid
      responses:
        '200':
          description: Job details
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/SuccessResponse'
        '404':
          $ref: '#/components/responses/NotFound'

  /jobs/{id}/status:
    put:
      summary: Update job status
      description: Change the status of a job (e.g., to In Progress, Completed).
      tags: [Jobs]
      security:
        - bearerAuth: []
      x-roles: [ADMIN, GM, TM, TO]
      parameters:
        - in: path
          name: id
          required: true
          schema:
            type: string
            format: uuid
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required: [status]
              properties:
                status:
                  type: string
                  enum: [PENDING, IN_PROGRESS, COMPLETED, CANCELLED]
      responses:
        '200':
          description: Status updated successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/SuccessResponse'

  /jobs/{id}/assign:
    put:
      summary: Assign surveyor
      description: Assign a surveyor to the job.
      tags: [Jobs]
      security:
        - bearerAuth: []
      x-roles: [ADMIN, GM]
      parameters:
        - in: path
          name: id
          required: true
          schema:
            type: string
            format: uuid
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required: [surveyorId]
              properties:
                surveyorId:
                  type: string
                  format: uuid
      responses:
        '200':
          description: Surveyor assigned successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/SuccessResponse'

  /jobs/{id}/messages:
    post:
      summary: Send message
      description: Post a message to the job discussion board.
      tags: [Jobs]
      security:
        - bearerAuth: []
      x-roles: [CLIENT, ADMIN, GM, TM, TO, SURVEYOR]
      parameters:
        - in: path
          name: id
          required: true
          schema:
            type: string
            format: uuid
      requestBody:
        content:
          multipart/form-data:
            schema:
              type: object
              properties:
                message:
                  type: string
                attachment:
                  type: string
                  format: binary
      responses:
        '201':
          description: Message sent
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/SuccessResponse'
